<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Membership Plans</title>
    <link rel="stylesheet" href="style.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
  href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
  rel="stylesheet"
/>

  </head>

  <body>
    <!-- HEADER -->
    <header class="header">
      <div class="logo">MemberFlow</div>
      <nav>
        <a href="index.html">Dashboard</a>
        <a href="members.html">Members</a>
        <a href="plans.html">Plans</a>
        <a href="payments.html">Payments</a>
        <a href="whatsapp-notifications.html">Whatsapp</a>
        <a href="#">Logout</a>
      </nav>
    </header>

    <!-- MAIN -->
    <main class="container">
      <!-- PAGE HEADER -->
      <div class="table-header">
        <h2 class="page-title">Membership Plans</h2>
        <a href="#add-plan-modal" class="add-member-btn">+ Add Plan</a>
      </div>

      <!-- PLANS -->
      <section class="plans" id="plansContainer">
        <!-- rendered by JS -->
      </section>
    </main>

    <!-- FOOTER -->
    <footer class="footer">© 2025 MemberFlow. All rights reserved.</footer>

    <!-- ADD PLAN MODAL -->
    <div id="add-plan-modal" class="modal">
      <div class="modal-content">
        <h3>Add Membership Plan</h3>

        <form class="modal-form" onsubmit="addPlan(event)">
          <label>Plan Name</label>
          <input id="addName" type="text" required />

          <label>Price</label>
          <input id="addPrice" type="text" required />

          <label>Duration</label>
          <input id="addDuration" type="text" required />

          <label>Features</label>
          <textarea id="addFeatures" placeholder="One feature per line"></textarea>

          <div class="modal-actions">
            <a href="#" class="secondary-btn">Cancel</a>
            <button class="primary-btn">Save Plan</button>
          </div>
        </form>
      </div>
    </div>

    <!-- EDIT PLAN MODAL -->
    <div id="edit-plan-modal" class="modal">
      <div class="modal-content">
        <h3>Edit Membership Plan</h3>

        <form class="modal-form" onsubmit="updatePlan(event)">
          <label>Plan Name</label>
          <input id="editName" type="text" required />

          <label>Price</label>
          <input id="editPrice" type="text" required />

          <label>Duration</label>
          <input id="editDuration" type="text" required />

          <label>Features</label>
          <textarea id="editFeatures"></textarea>

          <div class="modal-actions">
            <a href="#" class="secondary-btn">Cancel</a>
            <button class="primary-btn">Update Plan</button>
          </div>
        </form>
      </div>
    </div>

    <!-- SCRIPT -->
    <script>
      let plans =
        JSON.parse(sessionStorage.getItem("plans")) || [
          {
            id: 1,
            name: "Basic",
            price: "₹999",
            duration: "month",
            features: ["Single member access", "Email support"]
          },
          {
            id: 2,
            name: "Gold",
            price: "₹2,499",
            duration: "3 months",
            features: ["Priority support", "Multiple members"],
            popular: true
          },
          {
            id: 3,
            name: "Platinum",
            price: "₹4,999",
            duration: "6 months",
            features: ["Unlimited members", "Dedicated support"]
          }
        ];

      let editPlanId = null;

      function savePlans() {
        sessionStorage.setItem("plans", JSON.stringify(plans));
      }

      function renderPlans() {
        const container = document.getElementById("plansContainer");
        container.innerHTML = "";

        plans.forEach((plan) => {
          container.innerHTML += `
            <div class="plan-card ${plan.popular ? "popular" : ""}">
              ${plan.popular ? '<span class="badge">Most Popular</span>' : ""}
              <h3>${plan.name}</h3>
              <p class="price">${plan.price} / ${plan.duration}</p>
              <ul>
                ${plan.features.map((f) => `<li>${f}</li>`).join("")}
              </ul>
              <div class="plan-actions">
                <a href="#edit-plan-modal"
                   class="action-btn edit"
                   onclick="openEdit(${plan.id})">Edit</a>
              </div>
            </div>
          `;
        });
      }

      function addPlan(e) {
        e.preventDefault();

        plans.push({
          id: Date.now(),
          name: addName.value,
          price: addPrice.value,
          duration: addDuration.value,
          features: addFeatures.value.split("\n")
        });

        savePlans();
        renderPlans();
        location.hash = "";
        e.target.reset();
      }

      function openEdit(id) {
        const plan = plans.find((p) => p.id === id);
        editPlanId = id;

        editName.value = plan.name;
        editPrice.value = plan.price;
        editDuration.value = plan.duration;
        editFeatures.value = plan.features.join("\n");
      }

      function updatePlan(e) {
        e.preventDefault();

        const plan = plans.find((p) => p.id === editPlanId);
        plan.name = editName.value;
        plan.price = editPrice.value;
        plan.duration = editDuration.value;
        plan.features = editFeatures.value.split("\n");

        savePlans();
        renderPlans();
        location.hash = "";
      }

      window.onload = renderPlans;
    </script>
  </body>
</html>
